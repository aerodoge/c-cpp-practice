# C++ std::cin.ignore() è¯¦è§£

## æ¦‚è¿°

`std::cin.ignore()` æ˜¯ C++ æ ‡å‡†è¾“å…¥æµä¸­ç”¨äº**ä¸¢å¼ƒï¼ˆå¿½ç•¥ï¼‰å­—ç¬¦**çš„å‡½æ•°ï¼Œä¸»è¦ç”¨äºæ¸…ç©ºè¾“å…¥ç¼“å†²åŒºï¼Œé¿å…è¾“å…¥æµä¸­çš„æ®‹ç•™å­—ç¬¦å½±å“åç»­è¾“å…¥æ“ä½œã€‚

## æ ¸å¿ƒé—®é¢˜

### è¾“å…¥ç¼“å†²åŒºæ®‹ç•™

åœ¨ä½¿ç”¨ `std::cin` è¯»å–è¾“å…¥æ—¶ï¼Œå¸¸è§çš„é—®é¢˜æ˜¯**æ¢è¡Œç¬¦æ®‹ç•™åœ¨ç¼“å†²åŒº**ã€‚

```cpp
std::cout << "è¾“å…¥ä¸€ä¸ªæ•°å­—: ";
int num;
std::cin >> num;  // ç”¨æˆ·è¾“å…¥: 42 [å›è½¦]
```

**é—®é¢˜**ï¼š`std::cin >>` åªè¯»å–æ•°å­— `42`ï¼Œ**æ¢è¡Œç¬¦ `\n` è¿˜ç•™åœ¨ç¼“å†²åŒºé‡Œ**ï¼

```
é”®ç›˜è¾“å…¥ï¼š  4  2  [å›è½¦]
           â†“  â†“   â†“
ç¼“å†²åŒºï¼š   [42] [\n]
           â†‘    â†‘
         å·²è¯»  æ®‹ç•™
```

å¦‚æœä¸æ¸…ç©ºï¼Œä¸‹æ¬¡ä½¿ç”¨ `std::getline()` æˆ–å…¶ä»–è¾“å…¥æ“ä½œä¼šç«‹å³è¯»åˆ°è¿™ä¸ªæ®‹ç•™çš„ `\n`ï¼Œå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ã€‚

## åŸºæœ¬è¯­æ³•

### å‡½æ•°ç­¾å

```cpp
std::istream& ignore(std::streamsize count = 1, int delim = EOF);
```

### å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `count` | `std::streamsize` | `1` | æœ€å¤šå¿½ç•¥çš„å­—ç¬¦æ•° |
| `delim` | `int` | `EOF` | é‡åˆ°æ­¤å­—ç¬¦åœæ­¢ï¼ˆæ­¤å­—ç¬¦ä¹Ÿä¼šè¢«å¿½ç•¥ï¼‰ |

### è¿”å›å€¼

è¿”å› `std::istream&`ï¼ˆè¾“å…¥æµå¼•ç”¨ï¼‰ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€‚

## é¡¹ç›®ä¸­çš„åº”ç”¨

### Game.cpp:148

åœ¨å¤šè½®æ¸¸æˆä¸­ï¼Œæ¯è½®ä¹‹é—´ç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦ï¼š

```cpp
void Game::play_multiple_rounds(int numRounds) {
    for (int i = 0; i < numRounds; ++i) {
        play_round();  // ç©ä¸€è½®

        if (i < numRounds - 1) {  // ä¸æ˜¯æœ€åä¸€è½®
            std::cout << "\næŒ‰å›è½¦ç»§ç»­ä¸‹ä¸€è½®...";
            std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
            //              â†‘                                             â†‘
            //           å¿½ç•¥æœ€å¤šå­—ç¬¦                                   ç›´åˆ°æ¢è¡Œç¬¦
        }
    }
}
```

**ä½œç”¨**ï¼š
1. æ¸…ç©ºè¾“å…¥ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å­—ç¬¦
2. ç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦é”®
3. ä¸¢å¼ƒæ¢è¡Œç¬¦

### Game.cpp:185

åœ¨è¯»å–è½®æ•°åæ¸…ç©ºç¼“å†²åŒºï¼š

```cpp
std::cout << "ä½ æƒ³ç©å‡ è½®? ";
int numRounds;
std::cin >> numRounds;  // è¯»å–æ•°å­—
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
```

**å¿…è¦æ€§**ï¼šå¦‚æœä¸æ¸…ç©ºï¼Œåç»­çš„ `std::getline()` æˆ– `ignore()` ä¼šç«‹å³è¯»åˆ°æ®‹ç•™çš„æ¢è¡Œç¬¦ã€‚

## è¯¦ç»†è§£æ

### std::numeric_limits<std::streamsize>::max()

è¿™æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆå¤æ‚çš„è¡¨è¾¾å¼ï¼Œå®é™…å«ä¹‰æ˜¯ï¼š**"æœ€å¤§çš„æ•´æ•°"**ã€‚

#### åˆ†è§£

```cpp
std::numeric_limits<std::streamsize>::max()
     â†‘              â†‘                â†‘
   å‘½åç©ºé—´       æµå¤§å°ç±»å‹      é™æ€æ–¹æ³•
```

#### å„éƒ¨åˆ†å«ä¹‰

**1. `std::streamsize`**

æµå¤§å°çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯ `long long`ï¼š

```cpp
typedef long long streamsize;  // ç®€åŒ–ç†è§£
```

ç”¨äºè¡¨ç¤ºè¾“å…¥/è¾“å‡ºæµä¸­çš„å­—ç¬¦æ•°é‡ã€‚

**2. `std::numeric_limits<T>`**

C++ æ ‡å‡†åº“æä¾›çš„æ¨¡æ¿ç±»ï¼Œç”¨äºæŸ¥è¯¢æ•°å€¼ç±»å‹çš„å±æ€§ï¼š

```cpp
#include <limits>

std::numeric_limits<int>::max();        // int çš„æœ€å¤§å€¼ï¼š2147483647
std::numeric_limits<double>::max();     // double çš„æœ€å¤§å€¼
std::numeric_limits<char>::min();       // char çš„æœ€å°å€¼
```

**3. `::max()`**

é™æ€æˆå‘˜å‡½æ•°ï¼Œè¿”å›è¯¥ç±»å‹çš„æœ€å¤§å€¼ï¼š

```cpp
std::numeric_limits<std::streamsize>::max()
// é€šå¸¸è¿”å›ï¼š9223372036854775807 (2^63 - 1)
```

#### ä¸ºä»€ä¹ˆä½¿ç”¨è¿™ä¸ªå€¼ï¼Ÿ

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
//              â†‘
//          "å°½å¯èƒ½å¤šçš„å­—ç¬¦"
```

æ„æ€æ˜¯ï¼š**"å¿½ç•¥è¾“å…¥ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦"**

- å¦‚æœç¼“å†²åŒºæœ‰ 10 ä¸ªå­—ç¬¦ â†’ å¿½ç•¥ 10 ä¸ª
- å¦‚æœç¼“å†²åŒºæœ‰ 1000 ä¸ªå­—ç¬¦ â†’ å¿½ç•¥ 1000 ä¸ª
- å¦‚æœç¼“å†²åŒºæœ‰ `max` ä¸ªå­—ç¬¦ â†’ å¿½ç•¥ `max` ä¸ª

**æ€»ä¹‹**ï¼šæ— è®ºç¼“å†²åŒºæœ‰å¤šå°‘å­—ç¬¦ï¼Œéƒ½èƒ½æ¸…ç©ºï¼

### æ¢è¡Œç¬¦ '\n'

```cpp
std::cin.ignore(count, '\n');
//                      â†‘
//                   åˆ†éš”ç¬¦
```

**ä½œç”¨**ï¼šé‡åˆ° `'\n'` æ—¶åœæ­¢å¿½ç•¥ï¼Œå¹¶ä¸”**æŠŠ `'\n'` ä¹Ÿä¸¢å¼ƒ**ã€‚

#### è·¨å¹³å°æ¢è¡Œç¬¦

ä¸åŒæ“ä½œç³»ç»Ÿçš„æ¢è¡Œç¬¦ï¼š

| ç³»ç»Ÿ | æ¢è¡Œç¬¦ | è¯´æ˜ |
|------|--------|------|
| Unix/Linux/macOS | `\n` (LF) | Line Feed |
| Windows | `\r\n` (CRLF) | Carriage Return + Line Feed |
| è€å¼ Mac (OS 9) | `\r` (CR) | Carriage Return |

**å¥½æ¶ˆæ¯**ï¼šC++ çš„ `'\n'` ä¼šè‡ªåŠ¨å¤„ç†å¹³å°å·®å¼‚ï¼

```cpp
// åœ¨ä»»ä½•å¹³å°ä¸Šéƒ½æ­£ç¡®å·¥ä½œ
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ¸…ç©ºè¾“å…¥ç¼“å†²åŒº

#### é—®é¢˜ä»£ç 

```cpp
std::cout << "è¾“å…¥æ•°å­—: ";
int num;
std::cin >> num;  // ç”¨æˆ·è¾“å…¥: 42 [å›è½¦]

std::cout << "è¾“å…¥åå­—: ";
std::string name;
std::getline(std::cin, name);  // ç«‹å³è¯»åˆ°æ¢è¡Œç¬¦ï¼Œname ä¸ºç©ºï¼
```

**ç»“æœ**ï¼š
```
è¾“å…¥æ•°å­—: 42
è¾“å…¥åå­—:
```

`getline` ç«‹å³è¯»åˆ°æ®‹ç•™çš„ `\n`ï¼Œä¸ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼

#### æ­£ç¡®åšæ³•

```cpp
std::cout << "è¾“å…¥æ•°å­—: ";
int num;
std::cin >> num;
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº

std::cout << "è¾“å…¥åå­—: ";
std::string name;
std::getline(std::cin, name);  // æ­£å¸¸ç­‰å¾…ç”¨æˆ·è¾“å…¥
```

**ç»“æœ**ï¼š
```
è¾“å…¥æ•°å­—: 42
è¾“å…¥åå­—: Alice  âœ“
```

### åœºæ™¯2ï¼šç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦

```cpp
std::cout << "æŒ‰å›è½¦ç»§ç»­...";
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

**æ•ˆæœ**ï¼šç¨‹åºæš‚åœï¼Œç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦åç»§ç»­æ‰§è¡Œã€‚

### åœºæ™¯3ï¼šæ··åˆä½¿ç”¨ >> å’Œ getline

```cpp
int age;
std::string name;

std::cout << "å¹´é¾„: ";
std::cin >> age;  // è¯»å–æ•°å­—ï¼Œæ¢è¡Œç¬¦æ®‹ç•™
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©º

std::cout << "å§“å: ";
std::getline(std::cin, name);  // æ­£ç¡®è¯»å–ä¸€æ•´è¡Œ

std::cout << "ä½ å¥½ï¼Œ" << name << "ï¼Œä½  " << age << " å²äº†ã€‚\n";
```

### åœºæ™¯4ï¼šå¿½ç•¥é”™è¯¯è¾“å…¥

```cpp
int num;
while (true) {
    std::cout << "è¾“å…¥ä¸€ä¸ªæ•°å­— (1-10): ";
    std::cin >> num;

    if (std::cin.fail()) {  // è¾“å…¥å¤±è´¥ï¼ˆå¦‚è¾“å…¥äº†å­—æ¯ï¼‰
        std::cin.clear();  // æ¸…é™¤é”™è¯¯æ ‡å¿—
        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
        std::cout << "æ— æ•ˆè¾“å…¥ï¼Œè¯·é‡è¯•ã€‚\n";
        continue;
    }

    if (num >= 1 && num <= 10) {
        break;
    }

    std::cout << "æ•°å­—è¶…å‡ºèŒƒå›´ï¼Œè¯·é‡è¯•ã€‚\n";
}
```

## å¸¸è§å†™æ³•å¯¹æ¯”

### å†™æ³•1ï¼šä¸æŒ‡å®šå‚æ•°ï¼ˆä¸æ¨èï¼‰

```cpp
std::cin.ignore();
```

**è¡Œä¸º**ï¼šåªå¿½ç•¥ **1 ä¸ªå­—ç¬¦**ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚

**é—®é¢˜**ï¼šå¦‚æœç¼“å†²åŒºæœ‰å¤šä¸ªæ®‹ç•™å­—ç¬¦ï¼Œåªæ¸…ç©ºç¬¬ä¸€ä¸ªã€‚

```cpp
std::cin >> num;        // è¾“å…¥: 42 abc [å›è½¦]
std::cin.ignore();      // åªå¿½ç•¥ ' 'ï¼ˆç©ºæ ¼ï¼‰
// ç¼“å†²åŒºï¼š[abc\n]  â†’ è¿˜æœ‰æ®‹ç•™ï¼
```

### å†™æ³•2ï¼šå¿½ç•¥å›ºå®šæ•°é‡

```cpp
std::cin.ignore(100, '\n');
```

**è¡Œä¸º**ï¼šæœ€å¤šå¿½ç•¥ **100 ä¸ªå­—ç¬¦**ï¼Œæˆ–ç›´åˆ°é‡åˆ° `\n`ã€‚

**é—®é¢˜**ï¼šå¦‚æœç”¨æˆ·è¾“å…¥è¶…è¿‡ 100 ä¸ªå­—ç¬¦ï¼Œè¿˜ä¼šæœ‰æ®‹ç•™ã€‚

```cpp
// ç”¨æˆ·è¾“å…¥ 200 ä¸ªå­—ç¬¦
std::cin.ignore(100, '\n');  // åªæ¸…ç©ºå‰ 100 ä¸ª
// ç¼“å†²åŒºï¼š[å100ä¸ªå­—ç¬¦\n]  â†’ è¿˜æœ‰æ®‹ç•™ï¼
```

### å†™æ³•3ï¼šå¿½ç•¥"æ— é™"ä¸ªå­—ç¬¦ï¼ˆæ¨èï¼‰âœ¨

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

**è¡Œä¸º**ï¼šå¿½ç•¥**å°½å¯èƒ½å¤šçš„å­—ç¬¦**ï¼Œç›´åˆ°é‡åˆ° `\n`ã€‚

**ä¼˜ç‚¹**ï¼š
- âœ… èƒ½å¤„ç†ä»»æ„é•¿åº¦çš„è¾“å…¥
- âœ… ä¿è¯ç¼“å†²åŒºæ¸…ç©º
- âœ… æœ€å®‰å…¨çš„åšæ³•

### å†™æ³•4ï¼šä½¿ç”¨åˆ«åï¼ˆå¯è¯»æ€§æ›´å¥½ï¼‰

```cpp
#include <limits>

constexpr auto IGNORE_MAX = std::numeric_limits<std::streamsize>::max();

// ä½¿ç”¨
std::cin.ignore(IGNORE_MAX, '\n');
```

### å†™æ³•5ï¼šå°è£…æˆå‡½æ•°

```cpp
void clear_input_buffer() {
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
}

void wait_for_enter() {
    std::cout << "æŒ‰å›è½¦ç»§ç»­...";
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
}

// ä½¿ç”¨
clear_input_buffer();
wait_for_enter();
```

## å®é™…è¿è¡Œç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ¸¸æˆè½®æ¬¡æš‚åœ

```cpp
void Game::play_multiple_rounds(int numRounds) {
    for (int i = 0; i < numRounds; ++i) {
        std::cout << "\nè½® " << (i + 1) << " / " << numRounds << "\n";
        play_round();

        if (i < numRounds - 1) {
            std::cout << "\næŒ‰å›è½¦ç»§ç»­ä¸‹ä¸€è½®...";
            std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
        }
    }
}
```

**ç”¨æˆ·ä½“éªŒ**ï¼š
```
è½® 1 / 3
========================================
[æ¸¸æˆè¿›è¡Œ...]
========================================

æŒ‰å›è½¦ç»§ç»­ä¸‹ä¸€è½®... [ç”¨æˆ·æŒ‰å›è½¦] â† ç­‰å¾…

è½® 2 / 3
========================================
[æ¸¸æˆè¿›è¡Œ...]
========================================

æŒ‰å›è½¦ç»§ç»­ä¸‹ä¸€è½®... [ç”¨æˆ·æŒ‰å›è½¦] â† ç­‰å¾…

è½® 3 / 3
========================================
[æ¸¸æˆè¿›è¡Œ...]
========================================

[æ¸¸æˆç»“æŸï¼Œä¸å†ç­‰å¾…]
```

### ç¤ºä¾‹2ï¼šæ¸…ç©ºåˆå§‹è¾“å…¥ç¼“å†²åŒº

```cpp
std::cout << "ä½ æƒ³ç©å‡ è½®? ";
int numRounds;
std::cin >> numRounds;  // ç”¨æˆ·è¾“å…¥: 3 [å›è½¦]
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©º [å›è½¦]

// ç°åœ¨ç¼“å†²åŒºå¹²å‡€äº†ï¼Œåç»­è¾“å…¥ä¸ä¼šå—å½±å“
play_multiple_rounds(numRounds);
```

## å›¾è§£è¾“å…¥ç¼“å†²åŒº

### æ­¥éª¤1ï¼šç”¨æˆ·è¾“å…¥

```
ç”¨æˆ·é”®ç›˜è¾“å…¥ï¼š  4  2  [å›è½¦]
                â†“  â†“   â†“
è¾“å…¥ç¼“å†²åŒºï¼š   [4][2][\n]
```

### æ­¥éª¤2ï¼šstd::cin >> num

```cpp
int num;
std::cin >> num;  // è¯»å– 42
```

```
è¾“å…¥ç¼“å†²åŒºï¼š   [4][2][\n]
               â†‘  â†‘   â†‘
             å·²è¯»å–  æ®‹ç•™
```

`std::cin >>` åªè¯»å–æ•°å­—éƒ¨åˆ†ï¼Œ**æ¢è¡Œç¬¦è¿˜åœ¨ç¼“å†²åŒºï¼**

### æ­¥éª¤3ï¼šstd::cin.ignore()

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

```
è¾“å…¥ç¼“å†²åŒºï¼š   [4][2][\n]
               å·²è¯» å·²è¯» å·²å¿½ç•¥
                          â†“
è¾“å…¥ç¼“å†²åŒºï¼š   []  ï¼ˆç©ºï¼‰
```

æ‰€æœ‰å­—ç¬¦ï¼ˆåŒ…æ‹¬ `\n`ï¼‰éƒ½è¢«æ¸…ç©ºã€‚

## ä¸å…¶ä»–æ–¹æ³•å¯¹æ¯”

### æ–¹æ³•1ï¼šstd::cin.ignore()ï¼ˆæ¨èï¼‰

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸“é—¨ç”¨äºä¸¢å¼ƒå­—ç¬¦
- âœ… é«˜æ•ˆ
- âœ… ä¸éœ€è¦å­˜å‚¨è¯»å–çš„å†…å®¹

### æ–¹æ³•2ï¼šstd::cin.get()

```cpp
std::cin.get();  // è¯»å–ä¸€ä¸ªå­—ç¬¦
```

**åŒºåˆ«**ï¼š
- `get()` **è¯»å–å¹¶è¿”å›**å­—ç¬¦
- `ignore()` **ä¸¢å¼ƒ**å­—ç¬¦ï¼Œä¸è¿”å›

**é—®é¢˜**ï¼š`get()` åªè¯»ä¸€ä¸ªå­—ç¬¦ï¼Œæ— æ³•æ¸…ç©ºæ•´ä¸ªç¼“å†²åŒºã€‚

### æ–¹æ³•3ï¼šstd::getline() ä¸¢å¼ƒ

```cpp
std::string dummy;
std::getline(std::cin, dummy);  // è¯»å–ä¸€è¡Œä½†ä¸ä½¿ç”¨
```

**é—®é¢˜**ï¼š
- åˆ›å»ºäº†ä¸å¿…è¦çš„ `string` å¯¹è±¡
- æ€§èƒ½è¾ƒå·®
- è¯­ä¹‰ä¸æ¸…æ™°

### æ–¹æ³•4ï¼šå¾ªç¯ get()

```cpp
while (std::cin.get() != '\n') {
    // é€ä¸ªè¯»å–å¹¶ä¸¢å¼ƒ
}
```

**é—®é¢˜**ï¼š
- ä»£ç å†—é•¿
- æ€§èƒ½å·®
- ä¸å¦‚ `ignore()` ç®€æ´

### å¯¹æ¯”æ€»ç»“

| æ–¹æ³• | æ•ˆç‡ | ç®€æ´æ€§ | æ¨èåº¦ |
|------|------|--------|--------|
| `ignore(max, '\n')` | é«˜ | â­â­â­â­â­ | âœ… æ¨è |
| `get()` | ä¸­ | â­ | âŒ ä¸æ¨è |
| `getline(dummy)` | ä½ | â­â­ | âŒ ä¸æ¨è |
| å¾ªç¯ `get()` | ä½ | â­ | âŒ ä¸æ¨è |

## å¸¸è§é—®é¢˜

### Q1ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ `std::cin.sync()`ï¼Ÿ

**A**ï¼š`sync()` çš„è¡Œä¸ºæ˜¯**æœªå®šä¹‰**çš„ï¼ˆimplementation-definedï¼‰ï¼Œä¸å¯ç§»æ¤ã€‚

```cpp
std::cin.sync();  // è¡Œä¸ºä¸ç¡®å®šï¼Œå¯èƒ½ä¸å·¥ä½œ
```

**æ¨è**ï¼šä½¿ç”¨ `ignore()` æ›´å¯é ã€‚

### Q2ï¼šèƒ½å¦ç”¨ `std::cin.clear()` æ¸…ç©ºç¼“å†²åŒºï¼Ÿ

**A**ï¼š**ä¸èƒ½**ã€‚`clear()` åªæ¸…é™¤**é”™è¯¯æ ‡å¿—**ï¼Œä¸æ¸…ç©ºç¼“å†²åŒºã€‚

```cpp
std::cin.clear();  // åªæ¸…é™¤é”™è¯¯æ ‡å¿—ï¼ˆå¦‚ failbit, eofbitï¼‰
```

**æ­£ç¡®åšæ³•**ï¼š
```cpp
std::cin.clear();   // æ¸…é™¤é”™è¯¯æ ‡å¿—
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
```

### Q3ï¼š`ignore()` æ˜¯å¦ä¼šé˜»å¡ï¼Ÿ

**A**ï¼šå¦‚æœç¼“å†²åŒºä¸ºç©ºï¼Œ`ignore()` ä¼š**ç­‰å¾…è¾“å…¥**ç›´åˆ°è¯»åˆ°åˆ†éš”ç¬¦ã€‚

```cpp
// ç¼“å†²åŒºä¸ºç©º
std::cin.ignore(100, '\n');  // é˜»å¡ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥æ¢è¡Œç¬¦
```

è¿™æ­£æ˜¯æˆ‘ä»¬ç”¨å®ƒå®ç°"æŒ‰å›è½¦ç»§ç»­"çš„åŸç†ã€‚

### Q4ï¼šå¦‚ä½•å¿½ç•¥ç‰¹å®šå­—ç¬¦ï¼Ÿ

**A**ï¼šä¿®æ”¹ç¬¬äºŒä¸ªå‚æ•°ï¼ˆåˆ†éš”ç¬¦ï¼‰ã€‚

```cpp
std::cin.ignore(100, ' ');   // å¿½ç•¥ç›´åˆ°é‡åˆ°ç©ºæ ¼
std::cin.ignore(100, ',');   // å¿½ç•¥ç›´åˆ°é‡åˆ°é€—å·
std::cin.ignore(100, EOF);   // å¿½ç•¥ç›´åˆ°æ–‡ä»¶ç»“æŸ
```

### Q5ï¼š`ignore()` ä¼šä¸¢å¤±æ•°æ®å—ï¼Ÿ

**A**ï¼šæ˜¯çš„ï¼Œ`ignore()` **æ°¸ä¹…ä¸¢å¼ƒ**å­—ç¬¦ï¼Œæ— æ³•æ¢å¤ã€‚

```cpp
// ç¼“å†²åŒºï¼š[hello\n]
std::cin.ignore(100, '\n');
// ç¼“å†²åŒºï¼š[]  â†’ "hello" æ°¸ä¹…ä¸¢å¤±
```

ç¡®ä¿åªåœ¨éœ€è¦æ¸…ç©ºæ—¶ä½¿ç”¨ã€‚

## é”™è¯¯å¤„ç†

### æ£€æŸ¥è¾“å…¥å¤±è´¥

```cpp
int num;
std::cout << "è¾“å…¥æ•°å­—: ";
std::cin >> num;

if (std::cin.fail()) {
    std::cout << "è¾“å…¥å¤±è´¥ï¼\n";
    std::cin.clear();  // æ¸…é™¤é”™è¯¯æ ‡å¿—
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
    // å¯ä»¥é‡è¯•æˆ–é€€å‡º
}
```

### å¥å£®çš„è¾“å…¥å‡½æ•°

```cpp
int get_integer(const std::string& prompt) {
    int value;
    while (true) {
        std::cout << prompt;
        std::cin >> value;

        if (std::cin.fail()) {
            std::cin.clear();
            std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
            std::cout << "æ— æ•ˆè¾“å…¥ï¼Œè¯·è¾“å…¥æ•°å­—ã€‚\n";
            continue;
        }

        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
        return value;
    }
}

// ä½¿ç”¨
int age = get_integer("è¯·è¾“å…¥å¹´é¾„: ");
```

## æœ€ä½³å®è·µ

### 1. åœ¨ `>>` åæ€»æ˜¯æ¸…ç©ºç¼“å†²åŒº

```cpp
// âœ“ å¥½çš„åšæ³•
std::cin >> value;
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');

// âœ— å¯èƒ½å‡ºé—®é¢˜
std::cin >> value;  // æ²¡æœ‰æ¸…ç©ºç¼“å†²åŒº
```

### 2. ä½¿ç”¨å¸¸é‡æˆ–åˆ«åæé«˜å¯è¯»æ€§

```cpp
// âœ“ å¯è¯»æ€§å¥½
constexpr auto IGNORE_ALL = std::numeric_limits<std::streamsize>::max();
std::cin.ignore(IGNORE_ALL, '\n');

// âœ— å¯è¯»æ€§å·®
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

### 3. å°è£…å¸¸ç”¨æ“ä½œ

```cpp
namespace Input {
    void clear() {
        std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    }

    void wait() {
        std::cout << "æŒ‰å›è½¦ç»§ç»­...";
        clear();
    }
}

// ä½¿ç”¨
Input::clear();
Input::wait();
```

### 4. å¤„ç†è¾“å…¥é”™è¯¯

```cpp
// âœ“ å®Œæ•´çš„é”™è¯¯å¤„ç†
if (std::cin >> value) {
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    // æˆåŠŸ
} else {
    std::cin.clear();
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    // å¤±è´¥å¤„ç†
}

// âœ— æ²¡æœ‰é”™è¯¯å¤„ç†
std::cin >> value;  // å¯èƒ½å¤±è´¥ä½†æœªæ£€æŸ¥
```

### 5. åœ¨å¾ªç¯ä¸­ä½¿ç”¨

```cpp
// âœ“ æ­£ç¡®çš„åšæ³•
while (running) {
    std::cout << "å‘½ä»¤: ";
    std::string cmd;
    std::getline(std::cin, cmd);  // getline è‡ªåŠ¨å¤„ç†æ¢è¡Œç¬¦
    process(cmd);
}

// âœ— å¯èƒ½å‡ºé—®é¢˜ï¼ˆæ··ç”¨ >> å’Œ getlineï¼‰
while (running) {
    int choice;
    std::cin >> choice;  // è¯»å–æ•°å­—
    // ç¼ºå°‘ ignore()ï¼

    std::string input;
    std::getline(std::cin, input);  // ç«‹å³è¯»åˆ°æ¢è¡Œç¬¦
}
```

## æ€§èƒ½è€ƒè™‘

### ignore() çš„æ€§èƒ½

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

**æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯å¿½ç•¥çš„å­—ç¬¦æ•°ã€‚

**ç©ºé—´å¤æ‚åº¦**ï¼šO(1)ï¼Œä¸éœ€è¦é¢å¤–å­˜å‚¨ã€‚

### ä¸å…¶ä»–æ–¹æ³•å¯¹æ¯”

```cpp
// æ–¹æ³•1ï¼šignoreï¼ˆæœ€å¿«ï¼‰
std::cin.ignore(MAX, '\n');

// æ–¹æ³•2ï¼šgetline + ä¸¢å¼ƒï¼ˆè¾ƒæ…¢ï¼Œéœ€è¦åˆ†é… stringï¼‰
std::string dummy;
std::getline(std::cin, dummy);

// æ–¹æ³•3ï¼šå¾ªç¯ getï¼ˆæœ€æ…¢ï¼‰
while (std::cin.get() != '\n');
```

**ç»“è®º**ï¼š`ignore()` æ˜¯æœ€é«˜æ•ˆçš„é€‰æ‹©ã€‚

## é¡¹ç›®åº”ç”¨æ€»ç»“

### åœ¨æœ¬é¡¹ç›®ä¸­çš„ä½¿ç”¨

| ä½ç½® | ç›®çš„ | ä»£ç  |
|------|------|------|
| `Game.cpp:148` | ç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦ç»§ç»­ | `std::cin.ignore(max, '\n')` |
| `Game.cpp:185` | æ¸…ç©ºåˆå§‹è¾“å…¥ç¼“å†²åŒº | `std::cin.ignore(max, '\n')` |

### ä¸ºä»€ä¹ˆé‡è¦

1. **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›æ¸…æ™°çš„æ¸¸æˆèŠ‚å¥æ§åˆ¶
2. **è¾“å…¥å®‰å…¨**ï¼šé¿å…ç¼“å†²åŒºæ®‹ç•™å¯¼è‡´çš„å¼‚å¸¸
3. **ä»£ç å¥å£®**ï¼šå¤„ç†å„ç§è¾“å…¥æƒ…å†µ

## ç›¸å…³å‡½æ•°

### è¾“å…¥æµç›¸å…³å‡½æ•°

| å‡½æ•° | ä½œç”¨ | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|
| `std::cin >> var` | è¯»å–å˜é‡ | è¯»å–æ ¼å¼åŒ–è¾“å…¥ |
| `std::getline()` | è¯»å–ä¸€è¡Œ | è¯»å–å¸¦ç©ºæ ¼çš„å­—ç¬¦ä¸² |
| `std::cin.get()` | è¯»å–ä¸€ä¸ªå­—ç¬¦ | é€å­—ç¬¦å¤„ç† |
| `std::cin.ignore()` | ä¸¢å¼ƒå­—ç¬¦ | æ¸…ç©ºç¼“å†²åŒº |
| `std::cin.clear()` | æ¸…é™¤é”™è¯¯æ ‡å¿— | å¤„ç†è¾“å…¥é”™è¯¯ |
| `std::cin.fail()` | æ£€æŸ¥é”™è¯¯ | éªŒè¯è¾“å…¥æ˜¯å¦æˆåŠŸ |
| `std::cin.eof()` | æ£€æŸ¥æ–‡ä»¶ç»“æŸ | å¤„ç†æ–‡ä»¶è¾“å…¥ |

### ç»„åˆä½¿ç”¨ç¤ºä¾‹

```cpp
int value;
std::cin >> value;

if (std::cin.fail()) {
    std::cin.clear();   // æ¸…é™¤é”™è¯¯æ ‡å¿—
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
} else {
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');  // æ¸…ç©ºç¼“å†²åŒº
}
```

## æ€»ç»“

### std::cin.ignore() çš„æ ¸å¿ƒä½œç”¨

```cpp
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
```

1. **æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº** - ä¸¢å¼ƒæ‰€æœ‰æ®‹ç•™å­—ç¬¦
2. **ç­‰å¾…ç”¨æˆ·è¾“å…¥** - å®ç°"æŒ‰å›è½¦ç»§ç»­"
3. **å¤„ç†è¾“å…¥é”™è¯¯** - é…åˆ `clear()` æ¸…ç†é”™è¯¯çŠ¶æ€

### å…³é”®è¦ç‚¹

| è¦ç‚¹ | è¯´æ˜ |
|------|------|
| **ç¬¬ä¸€ä¸ªå‚æ•°** | `max` = å°½å¯èƒ½å¤šçš„å­—ç¬¦ |
| **ç¬¬äºŒä¸ªå‚æ•°** | `'\n'` = ç›´åˆ°æ¢è¡Œç¬¦ |
| **è¡Œä¸º** | ä¸¢å¼ƒå­—ç¬¦ï¼Œä¸è¿”å› |
| **é˜»å¡** | ç¼“å†²åŒºç©ºæ—¶ç­‰å¾…è¾“å…¥ |
| **å¸¸ç”¨åœºæ™¯** | `>>` ä¹‹åï¼Œç­‰å¾…å›è½¦ |

### å¿«é€Ÿå‚è€ƒ

```cpp
// åŒ…å«å¤´æ–‡ä»¶
#include <iostream>
#include <limits>

// æœ€å¸¸ç”¨å†™æ³•
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');

// ç®€åŒ–å†™æ³•ï¼ˆä½¿ç”¨åˆ«åï¼‰
constexpr auto IGNORE_MAX = std::numeric_limits<std::streamsize>::max();
std::cin.ignore(IGNORE_MAX, '\n');

// å°è£…æˆå‡½æ•°
void clear_cin() {
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
}
```

### è®°å¿†å£è¯€

> **"cin è¯»å®Œæ•°ï¼Œignore æ¸…ç¼“å†²"**
> **"getline ä¹‹å‰ï¼Œå…ˆæŠŠ ignore è°ƒ"**
> **"ç­‰å¾…å›è½¦é”®ï¼Œignore æœ€æ–¹ä¾¿"**

---

**æŒæ¡ `std::cin.ignore()`ï¼Œè®©ä½ çš„ C++ è¾“å…¥å¤„ç†æ›´å¥å£®ï¼** ğŸ¯
